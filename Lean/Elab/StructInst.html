<html lang="en"><head><meta charset="UTF-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><link rel="stylesheet" href="../.././style.css"></link><link rel="icon" href="../.././favicon.svg"></link><link rel="mask-icon" href="../.././favicon.svg" color="#000000"></link><link rel="prefetch" href="../.././/declarations/declaration-data.bmp" as="image"></link><title>Lean.Elab.StructInst</title><script defer="true" src="../.././mathjax-config.js"></script><script defer="true" src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script defer="true" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>const SITE_ROOT="../.././";</script><script>const MODULE_NAME="Lean.Elab.StructInst";</script><script type="module" src="../.././jump-src.js"></script><script type="module" src="../.././search.js"></script><script type="module" src="../.././expand-nav.js"></script><script type="module" src="../.././how-about.js"></script><script type="module" src="../.././instances.js"></script><script type="module" src="../.././importedBy.js"></script></head><body><input id="nav_toggle" type="checkbox"></input><header><h1><label for="nav_toggle"></label><span>Documentation</span></h1><h2 class="header_filename break_within"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">StructInst</span></h2><form id="search_form"><input type="text" name="q" autocomplete="off"></input>&#32;<button id="search_button" onclick="javascript: form.action='../.././search.html';">Search</button></form></header><nav class="internal_nav"><p><a href="#top">return to top</a></p><p class="gh_nav_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean">source</a></p><div class="imports"><details><summary>Imports</summary><ul><li><a href="../.././Lean/PrettyPrinter.html">Lean.PrettyPrinter</a></li><li><a href="../.././Lean/Elab/App.html">Lean.Elab.App</a></li><li><a href="../.././Lean/Elab/Binders.html">Lean.Elab.Binders</a></li><li><a href="../.././Lean/Meta/Structure.html">Lean.Meta.Structure</a></li><li><a href="../.././Lean/Parser/Term.html">Lean.Parser.Term</a></li><li><a href="../.././Lean/Util/FindExpr.html">Lean.Util.FindExpr</a></li></ul></details><details><summary>Imported by</summary><ul id="imported-by-Lean.Elab.StructInst" class="imported-by-list"></ul></details></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.expandStructInstExpectedType"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">expandStructInstExpectedType</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.mkStructInstField"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">mkStructInstField</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.expandStructInstFields"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">expandStructInstFields</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.ExplicitSourceView"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">ExplicitSourceView</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.instInhabitedExplicitSourceView"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">instInhabitedExplicitSourceView</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.SourcesView"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">SourcesView</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.instInhabitedSourcesView"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">instInhabitedSourcesView</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.SourcesView.isNone"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">SourcesView</span>.<span class="name">isNone</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.FieldLHS"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">FieldLHS</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.instInhabitedFieldLHS"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">instInhabitedFieldLHS</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.instToFormatFieldLHS"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">instToFormatFieldLHS</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.FieldVal"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">FieldVal</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.instInhabitedField"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">instInhabitedField</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.instInhabitedFieldVal"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">instInhabitedFieldVal</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.instInhabitedStructInstView"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">instInhabitedStructInstView</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.Field"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">Field</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.StructInstView"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">StructInstView</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.Field.isSimple"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">Field</span>.<span class="name">isSimple</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.StructInstView.allDefault"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">StructInstView</span>.<span class="name">allDefault</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.formatField"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">formatField</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.formatStruct"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">formatStruct</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.instToFormatStructInstView"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">instToFormatStructInstView</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.instToStringStructInstView"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">instToStringStructInstView</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.instToFormatField"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">instToFormatField</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.instToStringField"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">instToStringField</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.StructInstView.modifyFieldsM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">StructInstView</span>.<span class="name">modifyFieldsM</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.StructInstView.modifyFields"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">StructInstView</span>.<span class="name">modifyFields</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.mkProjStx?"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">mkProjStx?</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.findField?"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">findField?</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.CtorHeaderResult"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">CtorHeaderResult</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.markDefaultMissing"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">markDefaultMissing</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.defaultMissing?"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">defaultMissing?</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.throwFailedToElabField"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">throwFailedToElabField</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.trySynthStructInstance?"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">trySynthStructInstance?</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.ElabStructResult"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">ElabStructResult</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.DefaultFields.Context"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">Context</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.DefaultFields.State"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">State</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.DefaultFields.collectStructNames"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">collectStructNames</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.DefaultFields.getHierarchyDepth"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">getHierarchyDepth</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.DefaultFields.isDefaultMissing?"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">isDefaultMissing?</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.DefaultFields.findDefaultMissing?"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">findDefaultMissing?</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.DefaultFields.allDefaultMissing"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">allDefaultMissing</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.DefaultFields.allDefaultMissing.go"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">allDefaultMissing</span>.<span class="name">go</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.DefaultFields.getFieldName"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">getFieldName</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.DefaultFields.M"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">M</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.DefaultFields.isRoundDone"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">isRoundDone</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.DefaultFields.getFieldValue?"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">getFieldValue?</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.DefaultFields.mkDefaultValue?"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">mkDefaultValue?</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.DefaultFields.mkDefaultValue?.process"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">mkDefaultValue?</span>.<span class="name">process</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.DefaultFields.reduce"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">reduce</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.DefaultFields.reduce.withReduceLCtx"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">reduce</span>.<span class="name">withReduceLCtx</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.DefaultFields.tryToSynthesizeDefault"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">tryToSynthesizeDefault</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.DefaultFields.tryToSynthesizeDefault.loop"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">tryToSynthesizeDefault</span>.<span class="name">loop</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.DefaultFields.step"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">step</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.DefaultFields.propagateLoop"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">propagateLoop</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.DefaultFields.propagate"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">propagate</span></a></div><div class="nav_link"><a class="break_within" href="#Lean.Elab.Term.StructInst.elabStructInst"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">elabStructInst</span></a></div></nav><main>
<div class="mod_doc"><h1 class="markdown-heading" id="Structure-instance-elaborator">Structure instance elaborator <a class="hover-link" href="#Structure-instance-elaborator">#</a></h1><p>A <em>structure instance</em> is notation to construct a term of a <code>structure</code>.
Examples: <code>{ x := 2, y.z := true }</code>, <code>{ s with cache := c' }</code>, and <code>{ s with values[2] := v }</code>.
Structure instances are the preferred way to invoke a <code>structure</code>'s constructor,
since they hide Lean implementation details such as whether parents are represented as subobjects,
and also they do correct processing of default values, which are complicated due to the fact that <code>structure</code>s can override default values of their parents.</p><p>This module elaborates structure instance notation.
Note that the <code>where</code> syntax to define structures (<code><a href="../.././Lean/Parser/Command.html#Lean.Parser.Command.whereStructInst">Lean.Parser.Command.whereStructInst</a></code>)
macro expands into the structure instance notation elaborated by this module.</p></div><div class="mod_doc"><p>Recall that structure instances are (after removing parsing and pretty printing hints):</p><pre><code class="language-lean">def structInst := leading_parser
  &quot;{ &quot; &gt;&gt; <a href="../.././Init/Control/Basic.html#optional">optional</a> (sepBy1 termParser &quot;, &quot; &gt;&gt; &quot; with &quot;)
    &gt;&gt; structInstFields (sepByIndent structInstField &quot;, &quot; (allowTrailingSep := true))
    &gt;&gt; optEllipsis
    &gt;&gt; <a href="../.././Init/Control/Basic.html#optional">optional</a> (&quot; : &quot; &gt;&gt; termParser) &gt;&gt; &quot; }&quot;

def structInstField := leading_parser
  structInstLVal &gt;&gt; <a href="../.././Init/Control/Basic.html#optional">optional</a> (many structInstFieldBinder &gt;&gt; optType &gt;&gt; structInstFieldDecl)

@[builtin_structInstFieldDecl_parser]
def structInstFieldDef := leading_parser
  &quot; := &quot; &gt;&gt; termParser

@[builtin_structInstFieldDecl_parser]
def structInstFieldEqns := leading_parser
  matchAlts

def structInstWhereBody := leading_parser
  structInstFields (sepByIndent structInstField &quot;; &quot; (allowTrailingSep := true))

@[builtin_structInstFieldDecl_parser]
def structInstFieldWhere := leading_parser
  &quot;where&quot; &gt;&gt; structInstWhereBody
</code></pre></div><div class="decl" id="Lean.Elab.Term.StructInst.expandStructInstExpectedType"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L63-L74">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.expandStructInstExpectedType"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">expandStructInstExpectedType</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Init/Prelude.html#Lean.Macro">Lean.Macro</a></div></div><p>Transforms structure instances such as <code>{ x := 0 : Foo }</code> into <code>({ x := 0 } : Foo)</code>.
Structure instance notation makes use of the expected type.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.StructInst.expandStructInstExpectedType" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.mkStructInstField"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L76-L84">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.mkStructInstField"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">mkStructInstField</span></a></span><span class="decl_args">
<span class="fn">(lval : <span class="fn"><a href="../.././Init/Prelude.html#Lean.TSyntax">Lean.TSyntax</a> <span class="fn">`Lean.Parser.Term.structInstLVal</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(binders : <span class="fn"><a href="../.././Init/Prelude.html#Lean.TSyntaxArray">Lean.TSyntaxArray</a> <span class="fn">`Lean.Parser.Term.structInstFieldBinder</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(type? : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Init/Meta.html#Lean.Syntax.Term">Lean.Term</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(val : <a href="../.././Init/Meta.html#Lean.Syntax.Term">Lean.Term</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Lean.MacroM">Lean.MacroM</a> <span class="fn">(<a href="../.././Init/Prelude.html#Lean.TSyntax">Lean.TSyntax</a> <span class="fn">`Lean.Parser.Term.structInstField</span>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.StructInst.mkStructInstField" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.expandStructInstFields"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L111-L125">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.expandStructInstFields"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">expandStructInstFields</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Init/Prelude.html#Lean.Macro">Lean.Macro</a></div></div><p>Expands fields.</p><ul>
<li>Abbrevations. Example: <code>{ x }</code> expands to <code>{ x := x }</code>.</li>
<li>Equations. Example: <code>{ f | 0 =&gt; 0 | n + 1 =&gt; n }</code> expands to <code>{ f := fun x =&gt; match x with | 0 =&gt; 0 | n + 1 =&gt; n }</code>.</li>
<li>Binders and types. Example: <code>{ f n : <a href="../.././Init/Prelude.html#Nat">Nat</a> := n + 1 }</code> expands to <code>{ f := fun n =&gt; (n + 1 : Nat) }</code>.</li>
</ul><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.StructInst.expandStructInstFields" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.ExplicitSourceView"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L182-L190">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.ExplicitSourceView"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">ExplicitSourceView</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p>An <em>explicit source</em> is one of the structures <code>sᵢ</code> that appear in <code>{ s₁, …, sₙ with … }</code>.</p><ul class="structure_fields" id="Lean.Elab.Term.StructInst.ExplicitSourceView.mk"><li id="Lean.Elab.Term.StructInst.ExplicitSourceView.stx" class="structure_field"><div class="structure_field_info">stx : <a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a></div><div class="structure_field_doc"><p>The syntax of the explicit source.</p></div></li><li id="Lean.Elab.Term.StructInst.ExplicitSourceView.structName" class="structure_field"><div class="structure_field_info">structName : <a href="../.././Init/Prelude.html#Lean.Name">Lean.Name</a></div><div class="structure_field_doc"><p>The name of the structure for the type of the explicit source.</p></div></li></ul><details id="instances-for-list-Lean.Elab.Term.StructInst.ExplicitSourceView" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.instInhabitedExplicitSourceView"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L190-L190">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.instInhabitedExplicitSourceView"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">instInhabitedExplicitSourceView</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Inhabited">Inhabited</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.ExplicitSourceView">Lean.Elab.Term.StructInst.ExplicitSourceView</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.instInhabitedExplicitSourceView">Lean.Elab.Term.StructInst.instInhabitedExplicitSourceView</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">{ <span class="fn">default</span> := <span class="fn">{ <span class="fn">stx</span> := <span class="fn">default</span>, <span class="fn">structName</span> := <span class="fn">default</span> }</span> }</span></span></li></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.SourcesView"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L192-L200">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.SourcesView"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">SourcesView</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p>A view of the sources of fields for the structure instance notation.</p><ul class="structure_fields" id="Lean.Elab.Term.StructInst.SourcesView.mk"><li id="Lean.Elab.Term.StructInst.SourcesView.explicit" class="structure_field"><div class="structure_field_info">explicit : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.ExplicitSourceView">Lean.Elab.Term.StructInst.ExplicitSourceView</a></span></div><div class="structure_field_doc"><p>Explicit sources (i.e., one of the structures <code>sᵢ</code> that appear in <code>{ s₁, …, sₙ with … }</code>).</p></div></li><li id="Lean.Elab.Term.StructInst.SourcesView.implicit" class="structure_field"><div class="structure_field_info">implicit : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a></span></div><div class="structure_field_doc"><p>The syntax for a trailing <code>..</code>. This is &quot;ellipsis mode&quot; for missing fields, similar to ellipsis mode for applications.</p></div></li></ul><details id="instances-for-list-Lean.Elab.Term.StructInst.SourcesView" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.instInhabitedSourcesView"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L200-L200">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.instInhabitedSourcesView"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">instInhabitedSourcesView</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Inhabited">Inhabited</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.SourcesView">Lean.Elab.Term.StructInst.SourcesView</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.instInhabitedSourcesView">Lean.Elab.Term.StructInst.instInhabitedSourcesView</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">{ <span class="fn">default</span> := <span class="fn">{ <span class="fn">explicit</span> := <span class="fn">default</span>, <span class="fn">implicit</span> := <span class="fn">default</span> }</span> }</span></span></li></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.SourcesView.isNone"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L202-L205">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.SourcesView.isNone"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">SourcesView</span>.<span class="name">isNone</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.SourcesView">Lean.Elab.Term.StructInst.SourcesView</a> → <a href="../.././Init/Prelude.html#Bool">Bool</a></span></div></div><p>Returns <code>true</code> if the structure instance has no sources (neither explicit sources nor a <code>..</code>).</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><span class="fn">x✝</span>.isNone</span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn">match <span class="fn">x✝</span> with
  | <span class="fn">{ <span class="fn">explicit</span> := <span class="fn">#[]</span>, <span class="fn">implicit</span> := <span class="fn">none</span> }</span> =&gt; <a href="../.././Init/Prelude.html#Bool.true">true</a>
  | <span class="fn">x</span> =&gt; <a href="../.././Init/Prelude.html#Bool.false">false</a></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.StructInst.SourcesView.isNone" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.FieldLHS"><div class="inductive"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L342-L352">source</a></div><div class="decl_header"><span class="decl_kind">inductive</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.FieldLHS"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">FieldLHS</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p>A component of a left-hand side for a field appearing in structure instance syntax.</p><ul class="constructors"><li class="constructor" id="Lean.Elab.Term.StructInst.FieldLHS.fieldName">fieldName<span class="decl_args">
<span class="fn">(ref : <a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(name : <a href="../.././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
 : <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.FieldLHS">Lean.Elab.Term.StructInst.FieldLHS</a><div class="inductive_ctor_doc"><p>A name component for a field left-hand side. For example, <code>x</code> and <code>y</code> in <code>{ x.y := v }</code>.</p></div></li><li class="constructor" id="Lean.Elab.Term.StructInst.FieldLHS.fieldIndex">fieldIndex<span class="decl_args">
<span class="fn">(ref : <a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(idx : <a href="../.././Init/Prelude.html#Nat">Nat</a>)</span></span>
 : <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.FieldLHS">Lean.Elab.Term.StructInst.FieldLHS</a><div class="inductive_ctor_doc"><p>A numeric index component for a field left-hand side. For example <code>3</code> in <code>{ x.3 := v }</code>.</p></div></li><li class="constructor" id="Lean.Elab.Term.StructInst.FieldLHS.modifyOp">modifyOp<span class="decl_args">
<span class="fn">(ref index : <a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a>)</span></span>
 : <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.FieldLHS">Lean.Elab.Term.StructInst.FieldLHS</a><div class="inductive_ctor_doc"><p>An array indexing component for a field left-hand side. For example <code>[3]</code> in <code>{ arr[3] := v }</code>.</p></div></li></ul><details id="instances-for-list-Lean.Elab.Term.StructInst.FieldLHS" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.instInhabitedFieldLHS"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L352-L352">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.instInhabitedFieldLHS"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">instInhabitedFieldLHS</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Inhabited">Inhabited</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.FieldLHS">Lean.Elab.Term.StructInst.FieldLHS</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.instInhabitedFieldLHS">Lean.Elab.Term.StructInst.instInhabitedFieldLHS</a> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn">{ <span class="fn">default</span> := <span class="fn"><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.FieldLHS.fieldName">Lean.Elab.Term.StructInst.FieldLHS.fieldName</a> <span class="fn">default</span> <span class="fn">default</span></span> }</span></span></li></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.instToFormatFieldLHS"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L354-L358">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.instToFormatFieldLHS"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">instToFormatFieldLHS</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Data/Format/Basic.html#Std.ToFormat">Lean.ToFormat</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.FieldLHS">Lean.Elab.Term.StructInst.FieldLHS</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.FieldVal"><div class="inductive"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L361-L371">source</a></div><div class="decl_header"><span class="decl_kind">inductive</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.FieldVal"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">FieldVal</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p><code><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.FieldVal">FieldVal</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">StructInstView</a></code> is a representation of a field value in the structure instance.</p><ul class="constructors"><li class="constructor" id="Lean.Elab.Term.StructInst.FieldVal.term">term<span class="decl_args">
<span class="fn">(stx : <a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a>)</span></span>
 : <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.FieldVal">Lean.Elab.Term.StructInst.FieldVal</a><div class="inductive_ctor_doc"><p>A <code><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.FieldVal.term">term</a></code> to use for the value of the field.</p></div></li><li class="constructor" id="Lean.Elab.Term.StructInst.FieldVal.nested">nested<span class="decl_args">
<span class="fn">(s : <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">Lean.Elab.Term.StructInst.StructInstView</a>)</span></span>
 : <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.FieldVal">Lean.Elab.Term.StructInst.FieldVal</a><div class="inductive_ctor_doc"><p>A <code><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">StructInstView</a></code> to use for the value of a subobject field.</p></div></li><li class="constructor" id="Lean.Elab.Term.StructInst.FieldVal.default">default : <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.FieldVal">Lean.Elab.Term.StructInst.FieldVal</a><div class="inductive_ctor_doc"><p>A field that was not provided and should be synthesized using default values.</p></div></li></ul><details id="instances-for-list-Lean.Elab.Term.StructInst.FieldVal" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.instInhabitedField"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L371-L371">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.instInhabitedField"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">instInhabitedField</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Inhabited">Inhabited</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.Field">Lean.Elab.Term.StructInst.Field</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.instInhabitedField">Lean.Elab.Term.StructInst.instInhabitedField</a> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn">{ <span class="fn">default</span> := <span class="fn">{ <span class="fn">ref</span> := <span class="fn">default</span>, <span class="fn">lhs</span> := <span class="fn">default</span>, <span class="fn">val</span> := <span class="fn">default</span>, <span class="fn">expr?</span> := <span class="fn">default</span> }</span> }</span></span></li></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.instInhabitedFieldVal"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L371-L371">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.instInhabitedFieldVal"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">instInhabitedFieldVal</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Inhabited">Inhabited</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.FieldVal">Lean.Elab.Term.StructInst.FieldVal</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.instInhabitedFieldVal">Lean.Elab.Term.StructInst.instInhabitedFieldVal</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">{ <span class="fn">default</span> := <span class="fn"><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.FieldVal.term">Lean.Elab.Term.StructInst.FieldVal.term</a> <span class="fn">default</span></span> }</span></span></li></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.instInhabitedStructInstView"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L371-L371">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.instInhabitedStructInstView"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">instInhabitedStructInstView</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Inhabited">Inhabited</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">Lean.Elab.Term.StructInst.StructInstView</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.instInhabitedStructInstView">Lean.Elab.Term.StructInst.instInhabitedStructInstView</a> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn">{ <span class="fn">default</span> := <span class="fn">{ <span class="fn">ref</span> := <span class="fn">default</span>, <span class="fn">structName</span> := <span class="fn">default</span>, <span class="fn">params</span> := <span class="fn">default</span>, <span class="fn">fields</span> := <span class="fn">default</span>, <span class="fn">sources</span> := <span class="fn">default</span> }</span> }</span></span></li></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.Field"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L373-L386">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.Field"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">Field</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p><code><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.Field">Field</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">StructInstView</a></code> is a representation of a field in the structure instance.</p><ul class="structure_fields" id="Lean.Elab.Term.StructInst.Field.mk"><li id="Lean.Elab.Term.StructInst.Field.ref" class="structure_field"><div class="structure_field_info">ref : <a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a></div><div class="structure_field_doc"><p>The whole field syntax.</p></div></li><li id="Lean.Elab.Term.StructInst.Field.lhs" class="structure_field"><div class="structure_field_info">lhs : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.FieldLHS">Lean.Elab.Term.StructInst.FieldLHS</a></span></div><div class="structure_field_doc"><p>The LHS decomposed into components.</p></div></li><li id="Lean.Elab.Term.StructInst.Field.val" class="structure_field"><div class="structure_field_info">val : <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.FieldVal">Lean.Elab.Term.StructInst.FieldVal</a></div><div class="structure_field_doc"><p>The value of the field.</p></div></li><li id="Lean.Elab.Term.StructInst.Field.expr?" class="structure_field"><div class="structure_field_info">expr? : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a></span></div><div class="structure_field_doc"><p>The elaborated field value, filled in at <code>elabStruct</code>.
Missing fields use a metavariable for the elaborated value and are later solved for in <code><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.propagate">DefaultFields.propagate</a></code>.</p></div></li></ul><details id="instances-for-list-Lean.Elab.Term.StructInst.Field" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.StructInstView"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L388-L402">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">StructInstView</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p>The view for structure instance notation.</p><ul class="structure_fields" id="Lean.Elab.Term.StructInst.StructInstView.mk"><li id="Lean.Elab.Term.StructInst.StructInstView.ref" class="structure_field"><div class="structure_field_info">ref : <a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a></div><div class="structure_field_doc"><p>The syntax for the whole structure instance.</p></div></li><li id="Lean.Elab.Term.StructInst.StructInstView.structName" class="structure_field"><div class="structure_field_info">structName : <a href="../.././Init/Prelude.html#Lean.Name">Lean.Name</a></div><div class="structure_field_doc"><p>The name of the structure for the type of the structure instance.</p></div></li><li id="Lean.Elab.Term.StructInst.StructInstView.params" class="structure_field"><div class="structure_field_info">params : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href="../.././Init/Prelude.html#Lean.Name">Lean.Name</a> <a href="../.././Init/Prelude.html#Prod">×</a> <a href="../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a>)</span></span></div><div class="structure_field_doc"><p>Used for default values, to propagate structure type parameters. It is initially empty, and then set at <code>elabStruct</code>.</p></div></li><li id="Lean.Elab.Term.StructInst.StructInstView.fields" class="structure_field"><div class="structure_field_info">fields : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.Field">Lean.Elab.Term.StructInst.Field</a></span></div><div class="structure_field_doc"><p>The fields of the structure instance.</p></div></li><li id="Lean.Elab.Term.StructInst.StructInstView.sources" class="structure_field"><div class="structure_field_info">sources : <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.SourcesView">Lean.Elab.Term.StructInst.SourcesView</a></div><div class="structure_field_doc"><p>The additional sources for fields for the structure instance.</p></div></li></ul><details id="instances-for-list-Lean.Elab.Term.StructInst.StructInstView" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.Field.isSimple"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L405-L410">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.Field.isSimple"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">Field</span>.<span class="name">isSimple</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.Field">Lean.Elab.Term.StructInst.Field</a> → <a href="../.././Init/Prelude.html#Bool">Bool</a></span></div></div><p>Returns if the field has a single component in its LHS.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><span class="fn">{ <span class="fn">ref</span> := <span class="fn">ref</span>, <span class="fn">lhs</span> := <span class="fn">[<span class="fn">head</span>]</span>, <span class="fn">val</span> := <span class="fn">val</span>, <span class="fn">expr?</span> := <span class="fn">expr?</span> }</span>.isSimple</span> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Init/Prelude.html#Bool.true">true</a></span></li><li class="equation"><span class="fn"><span class="fn"><span class="fn">x✝</span>.isSimple</span> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Init/Prelude.html#Bool.false">false</a></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.StructInst.Field.isSimple" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.StructInstView.allDefault"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L412-L417">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView.allDefault"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">StructInstView</span>.<span class="name">allDefault</span></a></span><span class="decl_args">
<span class="fn">(s : <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">Lean.Elab.Term.StructInst.StructInstView</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Init/Prelude.html#Bool">Bool</a></div></div><p><code>true</code> iff all fields of the given structure are marked as <code><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.FieldVal.default">default</a></code></p></div></div><div class="decl" id="Lean.Elab.Term.StructInst.formatField"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L419-L424">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.formatField"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">formatField</span></a></span><span class="decl_args">
<span class="fn">(formatStruct : <span class="fn"><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">Lean.Elab.Term.StructInst.StructInstView</a> → <a href="../.././Init/Data/Format/Basic.html#Std.Format">Lean.Format</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(field : <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.Field">Lean.Elab.Term.StructInst.Field</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Init/Data/Format/Basic.html#Std.Format">Lean.Format</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.StructInst.formatField" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.formatStruct"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L426-L433">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.formatStruct"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">formatStruct</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">Lean.Elab.Term.StructInst.StructInstView</a> → <a href="../.././Init/Data/Format/Basic.html#Std.Format">Lean.Format</a></span></div></div></div></div><div class="decl" id="Lean.Elab.Term.StructInst.instToFormatStructInstView"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L435-L435">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.instToFormatStructInstView"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">instToFormatStructInstView</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Data/Format/Basic.html#Std.ToFormat">Lean.ToFormat</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">Lean.Elab.Term.StructInst.StructInstView</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.instToFormatStructInstView">Lean.Elab.Term.StructInst.instToFormatStructInstView</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">{ <span class="fn">format</span> := <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.formatStruct">Lean.Elab.Term.StructInst.formatStruct</a> }</span></span></li></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.instToStringStructInstView"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L436-L436">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.instToStringStructInstView"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">instToStringStructInstView</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Data/ToString/Basic.html#ToString">ToString</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">Lean.Elab.Term.StructInst.StructInstView</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.instToStringStructInstView">Lean.Elab.Term.StructInst.instToStringStructInstView</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">{ <span class="fn">toString</span> := <span class="fn"><span class="fn">toString</span> <a href="../.././Init/Prelude.html#Function.comp">∘</a> <span class="fn">Lean.format</span></span> }</span></span></li></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.instToFormatField"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L438-L438">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.instToFormatField"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">instToFormatField</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Data/Format/Basic.html#Std.ToFormat">Lean.ToFormat</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.Field">Lean.Elab.Term.StructInst.Field</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.instToFormatField">Lean.Elab.Term.StructInst.instToFormatField</a> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn">{ <span class="fn">format</span> := <span class="fn"><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.formatField">Lean.Elab.Term.StructInst.formatField</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.formatStruct">Lean.Elab.Term.StructInst.formatStruct</a></span> }</span></span></li></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.instToStringField"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L439-L439">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.instToStringField"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">instToStringField</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Data/ToString/Basic.html#ToString">ToString</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.Field">Lean.Elab.Term.StructInst.Field</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.instToStringField">Lean.Elab.Term.StructInst.instToStringField</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">{ <span class="fn">toString</span> := <span class="fn"><span class="fn">toString</span> <a href="../.././Init/Prelude.html#Function.comp">∘</a> <span class="fn">Lean.format</span></span> }</span></span></li></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.StructInstView.modifyFieldsM"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L512-L514">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView.modifyFieldsM"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">StructInstView</span>.<span class="name">modifyFieldsM</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{m : <span class="fn"><a href="../.././foundational_types.html">Type</a> → <a href="../.././foundational_types.html">Type</a></span>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#Monad">Monad</a> <span class="fn">m</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(s : <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">Lean.Elab.Term.StructInst.StructInstView</a>)</span></span>
<span class="decl_args">
<span class="fn">(f : <span class="fn"><span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.Field">Lean.Elab.Term.StructInst.Field</a></span> → <span class="fn"><span class="fn">m</span> <span class="fn">(<a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.Field">Lean.Elab.Term.StructInst.Field</a>)</span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">m</span> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">Lean.Elab.Term.StructInst.StructInstView</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.StructInst.StructInstView.modifyFieldsM" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.StructInstView.modifyFields"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L516-L517">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView.modifyFields"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">StructInstView</span>.<span class="name">modifyFields</span></a></span><span class="decl_args">
<span class="fn">(s : <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">Lean.Elab.Term.StructInst.StructInstView</a>)</span></span>
<span class="decl_args">
<span class="fn">(f : <span class="fn"><span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.Field">Lean.Elab.Term.StructInst.Field</a></span> → <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.Field">Lean.Elab.Term.StructInst.Field</a></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">Lean.Elab.Term.StructInst.StructInstView</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><span class="fn"><span class="fn">s</span>.modifyFields</span> <span class="fn">f</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><span class="fn">(<span class="fn"><span class="fn">s</span>.modifyFieldsM</span> <span class="fn">f</span>)</span>.run</span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.StructInst.StructInstView.modifyFields" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.mkProjStx?"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L609-L618">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.mkProjStx?"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">mkProjStx?</span></a></span><span class="decl_args">
<span class="fn">(s : <a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a>)</span></span>
<span class="decl_args">
<span class="fn">(structName fieldName : <a href="../.././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term.html#Lean.Elab.Term.TermElabM">Lean.Elab.TermElabM</a> <span class="fn">(<a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Init/Prelude.html#Lean.Syntax">Lean.Syntax</a>)</span></span></div></div><p>Creates projection notation for the given structure field. Used</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.StructInst.mkProjStx?" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.findField?"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L620-L627">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.findField?"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">findField?</span></a></span><span class="decl_args">
<span class="fn">(fields : <span class="fn"><a href="../.././Init/Prelude.html#List">List</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.Field">Lean.Elab.Term.StructInst.Field</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(fieldName : <a href="../.././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.Field">Lean.Elab.Term.StructInst.Field</a></span></div></div><p>Finds a simple field of the given name.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.StructInst.findField?" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.CtorHeaderResult"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L732-L743">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.CtorHeaderResult"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">CtorHeaderResult</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p>The constructor to use for the structure instance notation.</p><ul class="structure_fields" id="Lean.Elab.Term.StructInst.CtorHeaderResult.mk"><li id="Lean.Elab.Term.StructInst.CtorHeaderResult.ctorFn" class="structure_field"><div class="structure_field_info">ctorFn : <a href="../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a></div><div class="structure_field_doc"><p>The constructor function with applied structure parameters.</p></div></li><li id="Lean.Elab.Term.StructInst.CtorHeaderResult.ctorFnType" class="structure_field"><div class="structure_field_info">ctorFnType : <a href="../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a></div><div class="structure_field_doc"><p>The type of <code><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.CtorHeaderResult.ctorFn">ctorFn</a></code></p></div></li><li id="Lean.Elab.Term.StructInst.CtorHeaderResult.instMVars" class="structure_field"><div class="structure_field_info">instMVars : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Expr.html#Lean.MVarId">Lean.MVarId</a></span></div><div class="structure_field_doc"><p>Instance metavariables for structure parameters that are instance implicit.</p></div></li><li id="Lean.Elab.Term.StructInst.CtorHeaderResult.params" class="structure_field"><div class="structure_field_info">params : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <span class="fn">(<a href="../.././Init/Prelude.html#Lean.Name">Lean.Name</a> <a href="../.././Init/Prelude.html#Prod">×</a> <a href="../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a>)</span></span></div><div class="structure_field_doc"><p>Type parameter names and metavariables for each parameter. Used to seed <code><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView.params">StructInstView.params</a></code>.</p></div></li></ul><details id="instances-for-list-Lean.Elab.Term.StructInst.CtorHeaderResult" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.markDefaultMissing"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L785-L787">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.markDefaultMissing"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">markDefaultMissing</span></a></span><span class="decl_args">
<span class="fn">(e : <a href="../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a></div></div><p>Annotates an expression that it is a value for a missing field.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.markDefaultMissing">Lean.Elab.Term.StructInst.markDefaultMissing</a> <span class="fn">e</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Lean/Expr.html#Lean.mkAnnotation">Lean.mkAnnotation</a> <span class="fn">`structInstDefault</span> <span class="fn">e</span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.StructInst.markDefaultMissing" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.defaultMissing?"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L789-L791">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.defaultMissing?"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">defaultMissing?</span></a></span><span class="decl_args">
<span class="fn">(e : <a href="../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a></span></div></div><p>If the expression has been annotated by <code><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.markDefaultMissing">markDefaultMissing</a></code>, returns the unannotated expression.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.defaultMissing?">Lean.Elab.Term.StructInst.defaultMissing?</a> <span class="fn">e</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Lean/Expr.html#Lean.annotation?">Lean.annotation?</a> <span class="fn">`structInstDefault</span> <span class="fn">e</span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.StructInst.defaultMissing?" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.throwFailedToElabField"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L793-L795">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.throwFailedToElabField"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">throwFailedToElabField</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(fieldName structName : <a href="../.././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args">
<span class="fn">(msgData : <a href="../.././Lean/Message.html#Lean.MessageData">Lean.MessageData</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term.html#Lean.Elab.Term.TermElabM">Lean.Elab.TermElabM</a> <span class="fn">α</span></span></div></div><p>Throws &quot;failed to elaborate field&quot; error.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.StructInst.throwFailedToElabField" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.trySynthStructInstance?"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L797-L802">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.trySynthStructInstance?"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">trySynthStructInstance?</span></a></span><span class="decl_args">
<span class="fn">(s : <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">Lean.Elab.Term.StructInst.StructInstView</a>)</span></span>
<span class="decl_args">
<span class="fn">(expectedType : <a href="../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term.html#Lean.Elab.Term.TermElabM">Lean.Elab.TermElabM</a> <span class="fn">(<a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a>)</span></span></div></div><p>If the struct has all-missing fields, tries to synthesize the structure using typeclass inference.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.StructInst.trySynthStructInstance?" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.ElabStructResult"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L804-L811">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.ElabStructResult"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">ElabStructResult</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p>The result of elaborating a <code><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">StructInstView</a></code> structure instance view.</p><ul class="structure_fields" id="Lean.Elab.Term.StructInst.ElabStructResult.mk"><li id="Lean.Elab.Term.StructInst.ElabStructResult.val" class="structure_field"><div class="structure_field_info">val : <a href="../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a></div><div class="structure_field_doc"><p>The elaborated value.</p></div></li><li id="Lean.Elab.Term.StructInst.ElabStructResult.struct" class="structure_field"><div class="structure_field_info">struct : <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">Lean.Elab.Term.StructInst.StructInstView</a></div><div class="structure_field_doc"><p>The modified <code><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">StructInstView</a></code> view after elaboration.</p></div></li><li id="Lean.Elab.Term.StructInst.ElabStructResult.instMVars" class="structure_field"><div class="structure_field_info">instMVars : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Expr.html#Lean.MVarId">Lean.MVarId</a></span></div><div class="structure_field_doc"><p>Metavariables for instance implicit fields. These will be registered after default value propagation.</p></div></li></ul><details id="instances-for-list-Lean.Elab.Term.StructInst.ElabStructResult" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.DefaultFields.Context"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L877-L911">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.Context"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">Context</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p>Context for default value propagation.</p><ul class="structure_fields" id="Lean.Elab.Term.StructInst.DefaultFields.Context.mk"><li id="Lean.Elab.Term.StructInst.DefaultFields.Context.structs" class="structure_field"><div class="structure_field_info">structs : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">Lean.Elab.Term.StructInst.StructInstView</a></span></div><div class="structure_field_doc"><p>The current path through <code>.<a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.FieldVal.nested">nested</a></code> subobject structures. We must search for default values overridden in derived structures.</p></div></li><li id="Lean.Elab.Term.StructInst.DefaultFields.Context.allStructNames" class="structure_field"><div class="structure_field_info">allStructNames : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Init/Prelude.html#Lean.Name">Lean.Name</a></span></div><div class="structure_field_doc"><p>The collection of structures that could provide a default value.</p></div></li><li id="Lean.Elab.Term.StructInst.DefaultFields.Context.maxDistance" class="structure_field"><div class="structure_field_info">maxDistance : <a href="../.././Init/Prelude.html#Nat">Nat</a></div><div class="structure_field_doc"><p>Consider the following example:</p><pre><code class="language-lean">structure A where
  x : <a href="../.././Init/Prelude.html#Nat">Nat</a> := 1

structure B extends A where
  y : <a href="../.././Init/Prelude.html#Nat">Nat</a> := x + 1
  x := y + 1

structure C extends B where
  z : <a href="../.././Init/Prelude.html#Nat">Nat</a> := 2*y
  x := z + 3
</code></pre><p>And we are trying to elaborate a structure instance for <code>C</code>. There are default values for <code>x</code> at <code>A</code>, <code>B</code>, and <code>C</code>.
We say the default value at <code>C</code> has distance 0, the one at <code>B</code> distance 1, and the one at <code>A</code> distance 2.
The field <code><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.Context.maxDistance">maxDistance</a></code> specifies the maximum distance considered in a round of Default field computation.
Remark: since <code>C</code> does not set a default value of <code>y</code>, the default value at <code>B</code> is at distance 0.</p><p>The fixpoint for setting default values works in the following way.</p><ul>
<li>Keep computing default values using <code><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.Context.maxDistance">maxDistance</a> == 0</code>.</li>
<li>We increase <code><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.Context.maxDistance">maxDistance</a></code> whenever we failed to compute a new default value in a round.</li>
<li>If <code><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.Context.maxDistance">maxDistance</a> &gt; 0</code>, then we interrupt a round as soon as we compute some default value.
We use depth-first search.</li>
<li>We sign an error if no progress is made when <code><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.Context.maxDistance">maxDistance</a></code> == structure hierarchy depth (2 in the example above).</li>
</ul></div></li></ul><details id="instances-for-list-Lean.Elab.Term.StructInst.DefaultFields.Context" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.DefaultFields.State"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L913-L918">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.State"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">State</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p>State for default value propagation</p><ul class="structure_fields" id="Lean.Elab.Term.StructInst.DefaultFields.State.mk"><li id="Lean.Elab.Term.StructInst.DefaultFields.State.progress" class="structure_field"><div class="structure_field_info">progress : <a href="../.././Init/Prelude.html#Bool">Bool</a></div><div class="structure_field_doc"><p>Whether progress has been made so far on this round of the propagation loop.</p></div></li></ul><details id="instances-for-list-Lean.Elab.Term.StructInst.DefaultFields.State" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.DefaultFields.collectStructNames"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L920-L926">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.collectStructNames"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">collectStructNames</span></a></span><span class="decl_args">
<span class="fn">(struct : <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">Lean.Elab.Term.StructInst.StructInstView</a>)</span></span>
<span class="decl_args">
<span class="fn">(names : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Init/Prelude.html#Lean.Name">Lean.Name</a></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Init/Prelude.html#Lean.Name">Lean.Name</a></span></div></div><p>Collects all structures that may provide default values for fields.</p></div></div><div class="decl" id="Lean.Elab.Term.StructInst.DefaultFields.getHierarchyDepth"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L928-L933">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.getHierarchyDepth"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">getHierarchyDepth</span></a></span><span class="decl_args">
<span class="fn">(struct : <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">Lean.Elab.Term.StructInst.StructInstView</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Init/Prelude.html#Nat">Nat</a></div></div><p>Gets the maximum nesting depth of subobjects.</p></div></div><div class="decl" id="Lean.Elab.Term.StructInst.DefaultFields.isDefaultMissing?"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L935-L941">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.isDefaultMissing?"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">isDefaultMissing?</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{m : <span class="fn"><a href="../.././foundational_types.html">Type</a> → <a href="../.././foundational_types.html">Type</a></span>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#Monad">Monad</a> <span class="fn">m</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Lean/MetavarContext.html#Lean.MonadMCtx">Lean.MonadMCtx</a> <span class="fn">m</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(field : <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.Field">Lean.Elab.Term.StructInst.Field</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">m</span> <a href="../.././Init/Prelude.html#Bool">Bool</a></span></div></div><p>Returns whether the field is still missing.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.StructInst.DefaultFields.isDefaultMissing?" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.DefaultFields.findDefaultMissing?"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L943-L948">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.findDefaultMissing?"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">findDefaultMissing?</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{m : <span class="fn"><a href="../.././foundational_types.html">Type</a> → <a href="../.././foundational_types.html">Type</a></span>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#Monad">Monad</a> <span class="fn">m</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Lean/MetavarContext.html#Lean.MonadMCtx">Lean.MonadMCtx</a> <span class="fn">m</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(struct : <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">Lean.Elab.Term.StructInst.StructInstView</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">m</span> <span class="fn">(<a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.Field">Lean.Elab.Term.StructInst.Field</a>)</span></span></div></div><p>Returns a field that is still missing.</p></div></div><div class="decl" id="Lean.Elab.Term.StructInst.DefaultFields.allDefaultMissing"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L950-L959">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.allDefaultMissing"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">allDefaultMissing</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{m : <span class="fn"><a href="../.././foundational_types.html">Type</a> → <a href="../.././foundational_types.html">Type</a></span>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#Monad">Monad</a> <span class="fn">m</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Lean/MetavarContext.html#Lean.MonadMCtx">Lean.MonadMCtx</a> <span class="fn">m</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(struct : <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">Lean.Elab.Term.StructInst.StructInstView</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">m</span> <span class="fn">(<a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.Field">Lean.Elab.Term.StructInst.Field</a>)</span></span></div></div><p>Returns all fields that are still missing.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.allDefaultMissing">Lean.Elab.Term.StructInst.DefaultFields.allDefaultMissing</a> <span class="fn">struct</span></span> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><span class="fn"><span class="fn">(<span class="fn"><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.allDefaultMissing.go">Lean.Elab.Term.StructInst.DefaultFields.allDefaultMissing.go</a> <span class="fn">struct</span></span> *&gt; <span class="fn">get</span>)</span>.run'</span> <span class="fn">#[]</span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.StructInst.DefaultFields.allDefaultMissing" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.DefaultFields.allDefaultMissing.go"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L954-L959">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.allDefaultMissing.go"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">allDefaultMissing</span>.<span class="name">go</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{m : <span class="fn"><a href="../.././foundational_types.html">Type</a> → <a href="../.././foundational_types.html">Type</a></span>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Init/Prelude.html#Monad">Monad</a> <span class="fn">m</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[<span class="fn"><a href="../.././Lean/MetavarContext.html#Lean.MonadMCtx">Lean.MonadMCtx</a> <span class="fn">m</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(struct : <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">Lean.Elab.Term.StructInst.StructInstView</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Control/State.html#StateT">StateT</a> <span class="fn">(<a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.Field">Lean.Elab.Term.StructInst.Field</a>)</span> <span class="fn">m</span> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div></div></div><div class="decl" id="Lean.Elab.Term.StructInst.DefaultFields.getFieldName"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L961-L965">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.getFieldName"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">getFieldName</span></a></span><span class="decl_args">
<span class="fn">(field : <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.Field">Lean.Elab.Term.StructInst.Field</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././Init/Prelude.html#Lean.Name">Lean.Name</a></div></div><p>Returns the name of the field. Assumes all fields under consideration are simple and named.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.StructInst.DefaultFields.getFieldName" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.DefaultFields.M"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L967-L967">source</a></div><div class="attributes">@[reducible, inline]</div>
<div class="decl_header"><span class="decl_kind">abbrev</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.M"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">M</span></a></span><span class="decl_args">
<span class="fn">(α : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.M">Lean.Elab.Term.StructInst.DefaultFields.M</a> <a href="../.././Init/Prelude.html#Eq">=</a>   <span class="fn"><a href="../.././Init/Prelude.html#ReaderT">ReaderT</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.Context">Lean.Elab.Term.StructInst.DefaultFields.Context</a>
    <span class="fn">(<a href="../.././Init/Control/StateRef.html#StateRefT'">StateRefT'</a> <a href="../.././Init/System/IO.html#IO.RealWorld">IO.RealWorld</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.State">Lean.Elab.Term.StructInst.DefaultFields.State</a> <a href="../.././Lean/Elab/Term.html#Lean.Elab.Term.TermElabM">Lean.Elab.TermElabM</a>)</span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.StructInst.DefaultFields.M" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.DefaultFields.isRoundDone"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L969-L971">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.isRoundDone"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">isRoundDone</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.M">Lean.Elab.Term.StructInst.DefaultFields.M</a> <a href="../.././Init/Prelude.html#Bool">Bool</a></span></div></div><p>Returns whether we should interrupt the round because we have made progress allowing nonzero depth.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.isRoundDone">Lean.Elab.Term.StructInst.DefaultFields.isRoundDone</a> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn">do
  let <span class="fn">__do_lift</span> ← <span class="fn">get</span>
  let <span class="fn">__do_lift_1</span> ← <span class="fn">read</span>
  <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn">(<span class="fn"><span class="fn">__do_lift</span>.progress</span> <a href="../.././Init/Prelude.html#Bool.and">&amp;&amp;</a> <span class="fn"><a href="../.././Init/Prelude.html#Decidable.decide">decide</a> <span class="fn">(<span class="fn"><span class="fn">__do_lift_1</span>.maxDistance</span> <a href="../.././Init/Prelude.html#GT.gt">&gt;</a> <span class="fn">0</span>)</span></span>)</span></span></span></span></li></ul></details><details id="instances-for-list-Lean.Elab.Term.StructInst.DefaultFields.isRoundDone" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.DefaultFields.getFieldValue?"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L973-L979">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.getFieldValue?"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">getFieldValue?</span></a></span><span class="decl_args">
<span class="fn">(struct : <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">Lean.Elab.Term.StructInst.StructInstView</a>)</span></span>
<span class="decl_args">
<span class="fn">(fieldName : <a href="../.././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a></span></div></div><p>Returns the <code><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.Field.expr?">expr?</a></code> for the given field.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.StructInst.DefaultFields.getFieldValue?" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.DefaultFields.mkDefaultValue?"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L981-L1011">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.mkDefaultValue?"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">mkDefaultValue?</span></a></span><span class="decl_args">
<span class="fn">(struct : <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">Lean.Elab.Term.StructInst.StructInstView</a>)</span></span>
<span class="decl_args">
<span class="fn">(cinfo : <a href="../.././Lean/Declaration.html#Lean.ConstantInfo">Lean.ConstantInfo</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term.html#Lean.Elab.Term.TermElabM">Lean.Elab.TermElabM</a> <span class="fn">(<a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a>)</span></span></div></div><p>Instantiates a default value from the given default value declaration, if applicable.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.StructInst.DefaultFields.mkDefaultValue?" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.DefaultFields.mkDefaultValue?.process"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L987-L1011">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.mkDefaultValue?.process"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">mkDefaultValue?</span>.<span class="name">process</span></a></span><span class="decl_args">
<span class="fn">(struct : <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">Lean.Elab.Term.StructInst.StructInstView</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a> → <span class="fn"><a href="../.././Lean/Elab/Term.html#Lean.Elab.Term.TermElabM">Lean.Elab.TermElabM</a> <span class="fn">(<a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a>)</span></span></span></div></div></div></div><div class="decl" id="Lean.Elab.Term.StructInst.DefaultFields.reduce"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L1013-L1070">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.reduce"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">reduce</span></a></span><span class="decl_args">
<span class="fn">(structNames : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Init/Prelude.html#Lean.Name">Lean.Name</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(e : <a href="../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">Lean.MetaM</a> <a href="../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a></span></div></div><p>Reduces a default value. It performs beta reduction and projections of the given structures to reduce them to the provided values for fields.</p></div></div><div class="decl" id="Lean.Elab.Term.StructInst.DefaultFields.reduce.withReduceLCtx"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L1057-L1070">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.reduce.withReduceLCtx"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">reduce</span>.<span class="name">withReduceLCtx</span></a></span><span class="decl_args">
<span class="fn">(structNames : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Init/Prelude.html#Lean.Name">Lean.Name</a></span>)</span></span>
<span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(xs : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(k : <span class="fn"><a href="../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">Lean.MetaM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(i : <a href="../.././Init/Prelude.html#Nat">Nat</a> := <span class="fn">0</span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">Lean.MetaM</a> <span class="fn">α</span></span></div></div><p>Reduce the types and values of the local variables <code>xs</code> in the local context.</p></div></div><div class="decl" id="Lean.Elab.Term.StructInst.DefaultFields.tryToSynthesizeDefault"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L1072-L1108">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.tryToSynthesizeDefault"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">tryToSynthesizeDefault</span></a></span><span class="decl_args">
<span class="fn">(structs : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">Lean.Elab.Term.StructInst.StructInstView</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(allStructNames : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Init/Prelude.html#Lean.Name">Lean.Name</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(maxDistance : <a href="../.././Init/Prelude.html#Nat">Nat</a>)</span></span>
<span class="decl_args">
<span class="fn">(fieldName : <a href="../.././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args">
<span class="fn">(mvarId : <a href="../.././Lean/Expr.html#Lean.MVarId">Lean.MVarId</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term.html#Lean.Elab.Term.TermElabM">Lean.Elab.TermElabM</a> <a href="../.././Init/Prelude.html#Bool">Bool</a></span></div></div><p>Attempts to synthesize a default value for a missing field <code><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.FieldLHS.fieldName">fieldName</a></code> using default values from each structure in <code><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.Context.structs">structs</a></code>.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.StructInst.DefaultFields.tryToSynthesizeDefault" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.DefaultFields.tryToSynthesizeDefault.loop"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L1076-L1107">source</a></div><div class="attributes">@[irreducible]</div>
<div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.tryToSynthesizeDefault.loop"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">tryToSynthesizeDefault</span>.<span class="name">loop</span></a></span><span class="decl_args">
<span class="fn">(structs : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">Lean.Elab.Term.StructInst.StructInstView</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(allStructNames : <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <a href="../.././Init/Prelude.html#Lean.Name">Lean.Name</a></span>)</span></span>
<span class="decl_args">
<span class="fn">(maxDistance : <a href="../.././Init/Prelude.html#Nat">Nat</a>)</span></span>
<span class="decl_args">
<span class="fn">(fieldName : <a href="../.././Init/Prelude.html#Lean.Name">Lean.Name</a>)</span></span>
<span class="decl_args">
<span class="fn">(mvarId : <a href="../.././Lean/Expr.html#Lean.MVarId">Lean.MVarId</a>)</span></span>
<span class="decl_args">
<span class="fn">(i dist : <a href="../.././Init/Prelude.html#Nat">Nat</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term.html#Lean.Elab.Term.TermElabM">Lean.Elab.TermElabM</a> <a href="../.././Init/Prelude.html#Bool">Bool</a></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.StructInst.DefaultFields.tryToSynthesizeDefault.loop" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.DefaultFields.step"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L1110-L1128">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.step"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">step</span></a></span><span class="decl_args">
<span class="fn">(struct : <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">Lean.Elab.Term.StructInst.StructInstView</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.M">Lean.Elab.Term.StructInst.DefaultFields.M</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><p>Performs one step of default value synthesis.</p></div></div><div class="decl" id="Lean.Elab.Term.StructInst.DefaultFields.propagateLoop"><div class="opaque"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L1130-L1154">source</a></div><div class="decl_header"><span class="decl_kind">partial def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.propagateLoop"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">propagateLoop</span></a></span><span class="decl_args">
<span class="fn">(hierarchyDepth d : <a href="../.././Init/Prelude.html#Nat">Nat</a>)</span></span>
<span class="decl_args">
<span class="fn">(struct : <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">Lean.Elab.Term.StructInst.StructInstView</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.M">Lean.Elab.Term.StructInst.DefaultFields.M</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><p>Main entry point to default value synthesis in the <code><a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.M">M</a></code> monad.</p></div></div><div class="decl" id="Lean.Elab.Term.StructInst.DefaultFields.propagate"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L1156-L1162">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.DefaultFields.propagate"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">DefaultFields</span>.<span class="name">propagate</span></a></span><span class="decl_args">
<span class="fn">(struct : <a href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.StructInstView">Lean.Elab.Term.StructInst.StructInstView</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Elab/Term.html#Lean.Elab.Term.TermElabM">Lean.Elab.TermElabM</a> <a href="../.././Init/Prelude.html#Unit">Unit</a></span></div></div><p>Synthesizes default values for all missing fields, if possible.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.StructInst.DefaultFields.propagate" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div><div class="decl" id="Lean.Elab.Term.StructInst.elabStructInst"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover/lean4/blob/11651562caae0a0b3973811508db2ab8903d3854/src/Lean/Elab/StructInst.lean#L1195-L1205">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Lean/Elab/StructInst.html#Lean.Elab.Term.StructInst.elabStructInst"><span class="name">Lean</span>.<span class="name">Elab</span>.<span class="name">Term</span>.<span class="name">StructInst</span>.<span class="name">elabStructInst</span></a></span><span class="decl_args"> :</span><div class="decl_type"><a href="../.././Lean/Elab/Term.html#Lean.Elab.Term.TermElab">Lean.Elab.Term.TermElab</a></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details id="instances-for-list-Lean.Elab.Term.StructInst.elabStructInst" class="instances-for-list"><summary>Instances For</summary><ul class="instances-for-enum"></ul></details></div></div></main>
<nav class="nav"><iframe src="../.././navbar.html" class="navframe" frameBorder="0"></iframe></nav></body></html>